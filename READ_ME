In order to run the HMMER pipeline, the following must be provided: a list of genes for which to build profile HMMs, a fasta file of amino acid reference sequences for each gene, and a list of strains to HMMER search. Reference sequences for each gene were downloaded from the Integrated Microbial Genomes database (Chen et al., 2023) from genomes that passed the filtering requirements detailed above. In the first step of the HMMER pipeline, reference genomes for the provided list of strains are downloaded from NCBI using Entrez Direct (Kans, 2023). Reference genomes are translated from nucleotide to amino acid space using PRODIGAL (Hyatt et al., 2010). Concurrently, a multiple sequence alignment for each gene is constructed from the reference sequences using MAFFT (Katoh & Standley, 2013). This multiple sequence alignment is then used to build a profile HMM. A HMMER search is then performed against the profile HMM for each gene and each translated strain genome. Proceeding steps in the snakemake pipeline parse the results and return as CSV file with the highest scoring hit sequence for gene for each strain. 
	Subsequent analysis of HMMER search results in order to select HMMER hit sequences to add to the gene catalog was performed in R. Hit score distributions for each gene were visualized with ggplot2 and we determined a score cutoff of 50% of the lowest scoring model butyrate and propionate producer coincided with an obvious score drop off. After applying this score filter and a filter requiring all genes of a pathway must be present in a genome, the R script produces a CSV file of strains that passed all filtering requirements and the genome start and end positions of the HMMER hit sequence to be added to the gene catalog, which is required for the BOWTIE2 pipeline. 
	In order to perform the BOWTIE2 pipeline, the following must be provided: the CSV file detailed in the previous paragraph containing information on the strain and the gene hit ID (which contains the start and end positions of the sequence in the strain genome), a list of hit strains that contained a pathway for propionate or butyrate production, and a list of SRA accessions for metagenomic samples. This pipeline is divided into two major steps: compiling the gene catalog and performing the BOWTIE2 read mapping. 
In order to make the gene catalog, the strain genomes for each hit strain (that is, strains that contain genes that will be added to the gene catalog) are translated to nucleotide space using PRODIGAL. In house python scripts add header information for each open reading frame and search these headers for the sequences to be added to the gene catalog using sequence position information from the input CSV file. Finally, all sequences are compiled into one gene catalog nucleotide fasta file. 
To perform BOWTIE2 read mapping with the gene catalog, first, metagenomic raw reads are downloaded from the NCBIâ€™s SRA using the SRA Toolkit. Duplicate sequences are removed from the gene catalog. A bowtie index is constructed from the gene catalog and metagenomic raw reads are mapped to this index using BOWTIE2 with the parameters --very-sensitive and --end-to-end. The output of the read mapping is filtered using SAMtools (Danecek et al., 2021) and parsed with in house python scripts. Sequence lengths for each gene in the gene catalog are measured with an in house python script. The final output is a CSV file of the number of reads that are mapped to each gene in the catalog in each metagenomic sample. All tools were performed with default parameters unless otherwise specified. 
